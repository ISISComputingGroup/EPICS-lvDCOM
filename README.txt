== LvDCOM ==

lvDCOM is an EPICS IOC that exports front panel variables from National Instruments LabVIEW applications as 
EPICS process variables on computers running the Microsoft Windows operating system. The program allows you to 
"EPICS enable" LabVIEW without either purchasing the LabVIEW DSC module licence or needing 
to modify the VIs themselves. As the progam uses DCOM, this (ActiveX) needs to be selected in the "VI Server" options.
 
Features of lvDCOM are:
* Able to talk to either native LabVIEW VIs or a compiled LabVIEW application (.EXE)
  - For a compiled LabVIEW application, you need to select the "advanced properties" and check the 
    "enable ActiveX server" box and specify an "ActiveX server name" when you build the application. If you give, for example, 
	"MyApp" here then you would specify "MyApp.Application" as the progid parameter to lvDCOMConfigure() in your IOC st.cmd file. 
* Can (optionally) automatically start and/or stop Vis on IOC startup/shutdown
* Can communicate with remote computers using standard DCOM authentication or a supplied username + password
* Can handle additional front panel logic e.g. automatically push a button either before doing a read of after doing a write

The lvDCOM program is an Asyn driver that uses DCOM to communicate with LabVIEW. LabVIEW front panel items (controls and indicators)
are mapped to asyn driver parameters via an XML configuration file ("section" in XML file -> asyn port name), and these parameters 
can then be accessed via the EPICs records DTYP field.

The syntax of the XML configuration file is described in the "examples" subdirectory, but an initial XML file can be generated by the procedure below.
This procedure will also attempt to map LabVIEW rings/enums into EPICS MBBI/MBBO records, but as some of the value information is not available in 
the LabVIEW export process the results may need to be adjusted.

See the doc/html directory for further documentation 

=== Requirements ===

sed and xsltproc are required to generate an initial configuration file from the "exported strings" of a LabVIEW front panel.
Binaries for these are available from http://gnuwin32.sourceforge.net/packages/sed.htm and http://gnuwin32.sourceforge.net/packages/libxslt.htm

Building lvDCOM from source requires the full version of the Microsoft Visual Studio C++ compiler (I use ATL for DCOM and that is not in the express version).
A pre-built win32 lvDCOM binary can be downloaded from http://epics.isis.stfc.ac.uk/ which does not require any additional Microsoft tools/libraries to be installed.

=== Automatically generate XML configuration and EPICS DB files ===

First get a list of the available controls/indicators on the VI via:
* Open VI in LabVIEW  
* Go to Tools menu, Advanced, Export Strings... and uncheck the wizard option for "block diagram strings" and save to text file e.g. '''controls.txt''' (Note: you need write access to the VI itself to do this, so you may need to make a local copy)

For the next couple fo steps you need both the xsltproc and sed programs in your PATH - see requirements section above
 
First we need to correct the XML like output from LabVIEW so it can be read by XML utilities. Run:
<pre>
fix_xml controls.txt controls.xml
</pre>
to generate a '''controls.xml''' file. Then to generate the template XML file for LvDCOM run:
<pre>
xsltproc lvstrings2input.xsl controls.xml > lvinput.xml
</pre>
you can now edit '''lvinput.xml''' to remove or rename items etc. An XML schema definition file '''lvDCOMinput.xsd''' is also provided and, if present in the same directory as '''lvinput.xml''', should be picked up automatically by XML aware editors to make editing easier. Finally, to genereate a template EPICS DB record file for this type: 
<pre>
xsltproc lvinput2db.xsl lvinput.xml > epics.db
</pre>

The '''fix_xml''' and '''xsltproc''' commands above should not produce any screen output - if they do it is probably because they encountered an error parsing the file.

If you need further help, or discover any problems, plesae contact me (freddie.akeroyd at stfc.ac.uk)

=== License ===

lvDCOM is Copyright (c) 2013 STFC ISIS Facility, Rutherford Appleton Laboratory, GB. All rights reserved.
It is distributed under the EPICS Open License as detailed in the included LICENSE.txt file.

When distributed in binary form, the lvDCOM driver is linked against both the EPICS BASE and the ASYN driver software. 
These works are covered by licences in the enclosed LICENSE_EPICS_BASE.txt and LICENSE_ASYN.txt files respectively
and the following copyright notices:

* EPICS BASE Copyright *

Copyright (c) 1991-2011 UChicago Argonne LLC.
Copyright (c) 1991-2006 The Regents of the University of California.
Copyright (c) 2006-2011. Los Alamos National Security, LLC. Some of this
material was produced under U.S. Government contract DE-AC52-06NA25396
for Los Alamos National Laboratory (LANL), which is operated by Los Alamos
National Security, LLC for the U.S. Department of Energy.

* asyn Driver Copyright *

Copyright (c) 2002 University of Chicago, The Regents of the
University of California, and Berliner Elektronenspeicherring
Gesellschaft fuer Synchrotronstrahlung m.b.H. (BESSY) All rights
reserved.

Copyright (c) 2004 by Danfysik and Cosylab (Danfysik has funded the work
performed by Cosylab).

$Id$
